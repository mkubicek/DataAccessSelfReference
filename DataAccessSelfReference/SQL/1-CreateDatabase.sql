--- create database
CREATE DATABASE CodeSelfReference;
GO
USE CodeSelfReference;
GO


--- create scheme
CREATE TABLE Code (
Id int  NOT NULL IDENTITY(1, 1),
Name nvarchar(255)  NOT NULL,
CONSTRAINT Code_pk PRIMARY KEY  (Id)
);

CREATE TABLE CodeScope (
Code_Id int  NOT NULL,
Scope_Id int  NOT NULL,
CONSTRAINT CodeScope_pk PRIMARY KEY  (Code_Id,Scope_Id)
);

CREATE INDEX CodeScope_idx_1 on CodeScope (Scope_Id ASC,Code_Id ASC);

ALTER TABLE CodeScope ADD CONSTRAINT RestrictedFor_CodeScope_Code
FOREIGN KEY (Code_Id)
REFERENCES Code (Id);

ALTER TABLE CodeScope ADD CONSTRAINT Restricts_CodeScope_Code
FOREIGN KEY (Scope_Id)
REFERENCES Code (Id);


--- insert data
USE CodeSelfReference;
SET IDENTITY_INSERT CodeSelfReference.dbo.Code ON;
GO
INSERT INTO CodeSelfReference.dbo.Code (Id, Name) VALUES
(58001,'Group 1'),
(58002,'Group 2'),
(58003,'Group 3'),
(58004,'Group 4'),
(76001,'Value 1'),
(76002,'Value 2'),
(76003,'Value 3'),
(76004,'Value 4'),
(76005,'Value 5'),
(76006,'Value 6'),
(76007,'Value 7'),
(76008,'Value 8'),
(76009,'Value 9'),
(76010,'Value 10'),
(76011,'Value 11'),
(76012,'Value 12'),
(76013,'Value 13'),
(76014,'Value 14'),
(76015,'Value 15'),
(76016,'Value 16'),
(76017,'Value 17'),
(76018,'Value 18'),
(76019,'Value 19'),
(76020,'Value 20'),
(76021,'Value 21'),
(76022,'Value 22'),
(76023,'Value 23'),
(76024,'Value 24'),
(76025,'Value 25'),
(76026,'Value 26'),
(76027,'Value 27'),
(76028,'Value 28'),
(76029,'Value 29'),
(76030,'Value 30'),
(76031,'Value 31'),
(76032,'Value 32'),
(76033,'Value 33'),
(76034,'Value 34'),
(76035,'Value 35'),
(76036,'Value 36'),
(76037,'Value 37'),
(76038,'Value 38'),
(76039,'Value 39'),
(76040,'Value 40'),
(76041,'Value 41'),
(76042,'Value 42'),
(76043,'Value 43'),
(76044,'Value 44'),
(76045,'Value 45'),
(76046,'Value 46'),
(76047,'Value 47'),
(76048,'Value 48'),
(76049,'Value 49'),
(76050,'Value 50'),
(76051,'Value 51'),
(76052,'Value 52'),
(76053,'Value 53'),
(76054,'Value 54'),
(76055,'Value 55'),
(76056,'Value 56'),
(76057,'Value 57'),
(76058,'Value 58'),
(76059,'Value 59'),
(76060,'Value 60'),
(76061,'Value 61'),
(76062,'Value 62'),
(76063,'Value 63'),
(76064,'Value 64'),
(76065,'Value 65'),
(76066,'Value 66'),
(76067,'Value 67'),
(76068,'Value 68'),
(76069,'Value 69'),
(76070,'Value 70'),
(76071,'Value 71'),
(76072,'Value 72'),
(76073,'Value 73'),
(76074,'Value 74'),
(76075,'Value 75'),
(76076,'Value 76'),
(76077,'Value 77'),
(76078,'Value 78'),
(76079,'Value 79'),
(76080,'Value 80'),
(76081,'Value 81'),
(76082,'Value 82'),
(76083,'Value 83'),
(76084,'Value 84'),
(76085,'Value 85'),
(76086,'Value 86'),
(76087,'Value 87'),
(76088,'Value 88'),
(76089,'Value 89'),
(76090,'Value 90'),
(76091,'Value 91'),
(76092,'Value 92'),
(76093,'Value 93'),
(76094,'Value 94'),
(76095,'Value 95'),
(76096,'Value 96'),
(76097,'Value 97'),
(76098,'Value 98'),
(76099,'Value 99'),
(76100,'Value 100'),
(76101,'Value 101'),
(76102,'Value 102'),
(76103,'Value 103'),
(76104,'Value 104'),
(76105,'Value 105'),
(76106,'Value 106'),
(76107,'Value 107'),
(76108,'Value 108'),
(76109,'Value 109'),
(76110,'Value 110'),
(76111,'Value 111'),
(76112,'Value 112'),
(76113,'Value 113'),
(76114,'Value 114'),
(76115,'Value 115'),
(76116,'Value 116'),
(76117,'Value 117'),
(76118,'Value 118'),
(76119,'Value 119'),
(76120,'Value 120'),
(76121,'Value 121'),
(76122,'Value 122'),
(76123,'Value 123'),
(76124,'Value 124'),
(76125,'Value 125'),
(76126,'Value 126'),
(76127,'Value 127'),
(76128,'Value 128'),
(76129,'Value 129'),
(76130,'Value 130'),
(76131,'Value 131'),
(76132,'Value 132'),
(76133,'Value 133'),
(76134,'Value 134'),
(76135,'Value 135'),
(76136,'Value 136'),
(76137,'Value 137'),
(76138,'Value 138'),
(76139,'Value 139'),
(76140,'Value 140'),
(76141,'Value 141'),
(76142,'Value 142'),
(76143,'Value 143'),
(76144,'Value 144'),
(76145,'Value 145'),
(76146,'Value 146'),
(76147,'Value 147'),
(76148,'Value 148'),
(76149,'Value 149'),
(76150,'Value 150'),
(76151,'Value 151'),
(76152,'Value 152'),
(76153,'Value 153'),
(76154,'Value 154'),
(76155,'Value 155'),
(76156,'Value 156'),
(76157,'Value 157'),
(76158,'Value 158'),
(76159,'Value 159'),
(76160,'Value 160'),
(76161,'Value 161'),
(76162,'Value 162'),
(76163,'Value 163')

GO
SET IDENTITY_INSERT CodeSelfReference.dbo.Code OFF;
GO


INSERT INTO CodeScope VALUES
(76001,58001),
(76001,58002),
(76002,58001),
(76002,58002),
(76002,58004),
(76003,58001),
(76003,58002),
(76003,58004),
(76004,58004),
(76005,58004),
(76006,58004),
(76007,58004),
(76008,58001),
(76008,58004),
(76009,58004),
(76010,58004),
(76011,58004),
(76012,58004),
(76013,58004),
(76014,58004),
(76015,58004),
(76016,58004),
(76017,58004),
(76018,58004),
(76019,58004),
(76020,58004),
(76021,58004),
(76022,58003),
(76023,58004),
(76024,58004),
(76025,58004),
(76026,58003),
(76027,58001),
(76028,58004),
(76029,58004),
(76030,58004),
(76031,58004),
(76032,58004),
(76033,58004),
(76034,58004),
(76035,58004),
(76036,58004),
(76037,58004),
(76038,58004),
(76039,58004),
(76040,58004),
(76041,58004),
(76042,58004),
(76043,58004),
(76044,58004),
(76045,58004),
(76046,58004),
(76047,58004),
(76048,58004),
(76049,58004),
(76050,58004),
(76051,58003),
(76052,58004),
(76053,58004),
(76054,58004),
(76055,58004),
(76056,58004),
(76057,58004),
(76058,58004),
(76059,58004),
(76060,58004),
(76061,58004),
(76062,58004),
(76063,58004),
(76064,58004),
(76065,58004),
(76066,58004),
(76067,58004),
(76068,58004),
(76069,58004),
(76070,58004),
(76071,58004),
(76072,58004),
(76073,58004),
(76074,58004),
(76075,58004),
(76076,58004),
(76077,58004),
(76078,58004),
(76079,58004),
(76080,58004),
(76081,58003),
(76082,58004),
(76083,58004),
(76084,58004),
(76085,58004),
(76086,58004),
(76087,58004),
(76088,58004),
(76089,58004),
(76090,58004),
(76091,58004),
(76092,58003),
(76093,58003),
(76094,58004),
(76095,58004),
(76096,58004),
(76097,58004),
(76098,58004),
(76099,58004),
(76100,58004),
(76101,58004),
(76102,58004),
(76103,58004),
(76104,58004),
(76105,58004),
(76106,58004),
(76107,58004),
(76108,58004),
(76109,58004),
(76110,58004),
(76111,58003),
(76112,58004),
(76113,58004),
(76114,58004),
(76115,58004),
(76116,58004),
(76117,58004),
(76118,58004),
(76119,58004),
(76120,58004),
(76121,58004),
(76122,58004),
(76123,58004),
(76124,58004),
(76125,58004),
(76126,58004),
(76127,58004),
(76128,58004),
(76129,58004),
(76130,58004),
(76131,58004),
(76132,58004),
(76133,58004),
(76134,58004),
(76135,58004),
(76136,58004),
(76137,58004),
(76138,58004),
(76139,58004),
(76140,58004),
(76141,58004),
(76142,58004),
(76143,58004),
(76144,58004),
(76145,58004),
(76146,58004),
(76147,58004),
(76148,58004),
(76149,58004),
(76150,58004),
(76151,58004),
(76152,58004),
(76153,58004),
(76154,58004),
(76155,58004),
(76156,58004),
(76157,58004),
(76158,58004),
(76159,58004),
(76160,58004),
(76161,58004),
(76162,58004),
(76163,58004)




